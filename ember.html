<html>
  <meta>
     <meta charset="UTF-8">
   </meta>
  <head>
    <link href='dub.css' rel="stylesheet" type='text/css'></style>
    <script src="jquery-1.8.3.js"></script>
    <script src="handlebars-1.0.rc.1.js"></script>
    <script src="ember-1.0.0-pre.2.js"></script>
    <script src="dub-main.js"></script>
  </head>
  <body>
    <script type="text/javascript">
      DubMark.app        = DubMark.ApplicationController.create();
      DubMark.mark       = DubMark.MarkController.create();
      DubMark.activeMark = DubMark.ActiveMarkController.create();
    </script>
    <div id="main" class="main">
      <div id="video" class="video"> 
        <!-- Handle the video insert. -->
        <script type="text/x-handlebars" data-template-name="vid">
          <video {{bindAttr id="id"}} controls=true>
            <source {{bindAttr src="video" type="type"}} />
            Broken 
          </video>
        </script>
      </div>
      <div id="active" class="active"> 
        <script type="text/x-handlebars" data-template-name="active">
          {{#with DubMark.activeMark.active}}
          <p>{{view Em.TextArea valueBinding="DubMark.activeMark.active.source"}}</p>
          <p>{{view Em.TextArea valueBinding="DubMark.activeMark.active.text"}}</p>
          {{/with}}
        </script>
      </div>
      <div id="controls" class="controls"> 
        <!-- Insert the controls here. -->
      </div>
      <div id="subtitle" class="subtitle">
        <!-- Insert all the subtitle information. -->
        Subtitles HERE
        <script type="text/x-handlebars" data-template-name="subtitle">
          <table class='mark'>
             <thead>
               <tr>
                 <th>Source</th>
                 <th>Translation</th>
                 <th>Start</th>
                 <th>End</th>
               </tr>
             </thead>
             <tbody>
               {{#collection DubMark.mark}}
               {{#view DubMark.SubView contentBinding="this"}}
                 <tr>
                 <td>{{source}}</td>
                 <td>{{text}}</td>
                 <td>{{start}}</td>
                 <td>{{end}}</td>
                 </tr>
              {{/view}}
            {{/collection}}
            </tbody>
          </table>
        </script>
      </div>
    </div>
    <script type="text/x-handlebars" data-template-name="application">
    </script>
  </body>
  <!-- Initialization code -->
  <script type="text/javascript">
    var init = {id: "DubAndMark"};
  </script>
  <script type="text/javascript">
    $(function(){
      DmP = DubMark.Project.create(init);
      DmP.connect({id: 'DubAndMark'});
      var test = $("#controls");
      test.append(
        $('<button>', {text: 'New M',      click: DmP.newMark.bind(DmP, null)}),
        $('<button>', {text: 'End M',      click: DmP.endMark.bind(DmP, null)}),
        $('<button>', {text: 'Pause M',    click: DmP.pauseMark.bind(DmP)}),
        $('<button>', {text: 'Edit M',     click: DmP.editMark.bind(DmP)}),
        $('<button>', {text: 'get Active', click: DmP.getActiveMark.bind(DmP)}),
        $('<button>', {text: 'set Active', click: DmP.setActiveMark.bind(DmP)}),
        $('<button>', {text: 'esc Mark',   click: DmP.escMark.bind(DmP, null)})
      );

      var v = DmP.getVideoCtrl();
          v.appendTo('#video');
          v.listen();

       var mv = DubMark.MarkView.create();
       mv.appendTo('#subtitle');

       DubMark.mark.newSub('s', 'e', 't');

       var am = DubMark.ActiveView.create();
       am.appendTo('#active');
    });
    

    //Create the Active Control
    

    //Create the Subtitle Control

    //Create the Video Control
  </script>
</html>
