<!DOCTYPE html>
<html ng-app='dub'>
  <meta charset="UTF-8"/>
  <head>
    <link href='css/dub.css' rel="stylesheet" type='text/css'></style>
    <link href='js/bootstrap/css/bootstrap.css' rel="stylesheet" type='text/css'></style>
    <link href='js/bootstrap/css/bootstrap-responsive.css' rel="stylesheet" type='text/css'></style>
    <link href='js/jquery/css/ui-lightness/jquery-ui-1.10.2.custom.css' rel="stylesheet" type='text/css'></style>
  </head>
  <body>

    <!-- Some sort of Banner? -->

    <!-- Probably want to make this entire thing into a template -->
    <div ng-controller="DubMark.ProjectListings" class="listings container-fluid ">
      <div class="row-fluid">
        <div class="span5">
          <div class="navbar navbar-inner">
          <form class="span13 navbar-form">
            <span class='brand'>Projects</span>
              <button title='Create a new project' ng-click="list.createDialog()"    class="btn">
                <i class="icon-plus-sign"></i>
              </button>
              &nbsp;
              &nbsp;
              &nbsp;
              <button title='Previous' ng-click="list.prev()"    class="btn">
                <i class="icon-step-backward"></i>
              </button>
              <button title='Refresh'  ng-click="list.refresh()" class="btn">
                <i class="icon-refresh"></i>
              </button>
              <button title='Next'     ng-click="list.next()"    class="btn">
                <i class="icon-step-forward"></i>
              </button>


              <button title='Search'   ng-click="list.search()"  class="btn pull-right">
                <i class="icon-search"></i>
              </button>
              <input type="text"       ng-model="list.filter"    class="pull-right" placeholder="Filter projects"> </input>
          </form>
          </div>
          <ul class="nav nav-list">
            <li class='{{list.isActive(proj)}}' ng-repeat="proj in list.arr" ng-click="list.setActive(proj)"> 
            <a>
              {{proj.title}} 
              <span> - {{proj.state || 'state'}} {{proj.date}}</span> <!-- Use icons -->
            </a>
            </li>
          </ul>
        </div>

        <div class="span7 project_info">
          <div class="navbar navbar-inner">
            <span class='brand'> Project Information: {{list.active.title}}</span>
            <button ng-disabled="!list.active" class="btn pull-right" title="Open to edit" ng-click="list.openActive()">
              <i class="icon-edit"></i>
            </button>
          </div>
          <div>
            {{list.active.description}}
            Image:
            State:
            Translator:
            QA:  
            Publish Status: 
          </div>
        </div>

      </div>

      <div class="hidden" id="newProject">
        <input  ng-model="list.newProject.title" type=text placeholder="Title"/>
        <input  ng-model="list.newProject.vid" type=text placeholder="Video url"/>
        <button ng-disabled='list.disableCreateButton' class="btn" ng-click="list.createAndOpen()"> Confirm</button>
      </div>
    </div> <!-- End main controller section -->


    <!-- All the script includes -->
    <script src="js/jquery/js/jquery-1.9.1.js"> </script>  
    <script src="js/jquery/js/jquery-ui-1.10.2.custom.js"> </script>
    <script src="js/bootstrap/js/bootstrap.js"> </script>  
    <script src="js/angular.js"></script>
    <script src="js/angular-resource.js"></script>
    <script src="js/dub-mark.js"></script>


    <script type="text/javascript">
      var dub = angular.module('dub', ['ngResource']);


      function fuck(){ console.log("FUCK"); }

      DubMark.Config.base.url = 'http://localhost:3000/';
      DubMark.ProjectListings = function($scope, $resource){

        console.log("Why is this thing such a hunk of crap?", $resource);
        
        var ld = $resource(
            'projects', 
            {format: 'json'}, //Fucking docs...
            { 'get':    {method:'GET', isArray: true},
              'save':   {method:'POST'},
              'query':  {method:'GET', isArray:true},
              'remove': {method:'DELETE'},
              'delete': {method:'DELETE'} 
            }
        );

        var list = new DubMark.ProjectList();
        list.$scope = $scope;
        list.loader = ld;
        $scope.list = list;
        list.load();
      };
    </script>
  </body>
</html>
